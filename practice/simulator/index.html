<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Flash Loan Practice Simulator – Crypto For Seniors</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      background: #0b0b0b;
      color: #e6e6e6;
      font-family: Arial, Helvetica, sans-serif;
      text-align: center;
    }

    .container {
      max-width: 900px;
      margin: auto;
      padding: 60px 20px;
    }

    h1 {
      color: #4da3ff;
    }

    .banner {
      background: #1e1e1e;
      border: 2px solid #ffb84d;
      padding: 15px;
      margin: 30px auto;
      max-width: 720px;
      font-weight: bold;
    }

    p {
      max-width: 720px;
      margin: 20px auto;
      line-height: 1.6;
    }

    input {
      padding: 12px;
      font-size: 1.1rem;
      width: 220px;
      text-align: center;
      border-radius: 6px;
      border: none;
    }

    button {
      margin-top: 20px;
      padding: 14px 28px;
      font-size: 1.1rem;
      font-weight: bold;
      background: #4da3ff;
      color: #000;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .result {
      margin-top: 40px;
      padding: 20px;
      border: 1px solid #333;
      background: #141414;
      max-width: 720px;
      margin-left: auto;
      margin-right: auto;
      display: none;
    }

    .nav {
      margin-top: 50px;
    }

    .nav a {
      color: #4da3ff;
      font-weight: bold;
      text-decoration: none;
    }
  </style>
</head>

<body>
<div class="container">

  <h1 id="title"></h1>

  <div class="banner" id="banner"></div>

  <p id="intro"></p>
  <p id="safety"></p>
  <p id="prompt"></p>

  <input id="loanAmount" type="number" placeholder="10000" />
  <br />
  <button onclick="runSimulation()" id="simulateBtn"></button>

  <div id="resultBox" class="result"></div>

  <div class="nav">
    <a href="../" id="backLink"></a>
  </div>

</div>

<script>
const text = {
  en: {
    title: "Flash Loan Practice Simulator",
    banner: "PRACTICE ONLY — Fake funds, real prices, no wallets, no transactions",
    intro: "This simulator demonstrates how flash loans work using simulated balances and real market prices.",
    safety: "Nothing here can access your wallet or move funds.",
    prompt: "Enter a simulated loan amount (USDC):",
    simulate: "Simulate",
    back: "← Back to Practice Overview",
    loading: "Loading real market price…",
    invalid: "Please enter a valid simulated loan amount.",
    fail: "Unable to fetch market data. Please try again later.",
    result: "Simulation Result",
    market: "Market price used",
    loan: "Simulated loan",
    cost: "Estimated costs",
    gain: "Estimated gain",
    profit: "Result: Profit",
    loss: "Result: Loss",
    explain: "This outcome shows why fees, spreads, and timing matter."
  },
  fr: {
    title: "Simulateur de Prêt Flash",
    banner: "MODE PRATIQUE — Fonds simulés, prix réels",
    intro: "Ce simulateur montre le fonctionnement des prêts flash.",
    safety: "Aucun accès au portefeuille ni transactions.",
    prompt: "Entrez un montant simulé (USDC) :",
    simulate: "Simuler",
    back: "← Retour au mode pratique",
    loading: "Chargement du prix du marché…",
    invalid: "Veuillez entrer un montant valide.",
    fail: "Impossible de charger les données.",
    result: "Résultat de la simulation",
    market: "Prix du marché",
    loan: "Prêt simulé",
    cost: "Coûts estimés",
    gain: "Gain estimé",
    profit: "Résultat : Profit",
    loss: "Résultat : Perte",
    explain: "Les frais et écarts affectent les résultats."
  }
};

const lang = localStorage.getItem("cfs-lang") || "en";
const t = text[lang] || text.en;

document.getElementById("title").innerText = t.title;
document.getElementById("banner").innerText = t.banner;
document.getElementById("intro").innerText = t.intro;
document.getElementById("safety").innerText = t.safety;
document.getElementById("prompt").innerText = t.prompt;
document.getElementById("simulateBtn").innerText = t.simulate;
document.getElementById("backLink").innerText = t.back;

async function runSimulation() {
  const input = document.getElementById("loanAmount");
  const resultBox = document.getElementById("resultBox");
  const loan = parseFloat(input.value);

  if (isNaN(loan) || loan <= 0) {
    alert(t.invalid);
    return;
  }

  resultBox.style.display = "block";
  resultBox.innerHTML = t.loading;

  try {
    const res = await fetch(
      "https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd"
    );
    const data = await res.json();
    const price = data.ethereum.usd;

    const cost = loan * 0.003;
    const gain = loan * 0.0025;
    const net = gain - cost;

    resultBox.innerHTML = `
      <h3>${t.result}</h3>
      <p><strong>${t.market}:</strong> ETH ≈ $${price}</p>
      <p><strong>${t.loan}:</strong> $${loan.toLocaleString()}</p>
      <p><strong>${t.cost}:</strong> $${cost.toFixed(2)}</p>
      <p><strong>${t.gain}:</strong> $${gain.toFixed(2)}</p>
      <p style="color:${net>0?'#7CFC98':'#ff7c7c'};">
        <strong>${net>0?t.profit:t.loss}:</strong> $${Math.abs(net).toFixed(2)}
      </p>
      <p>${t.explain}</p>
    `;
  } catch {
    resultBox.innerText = t.fail;
  }
}
</script>

</body>
</html>
